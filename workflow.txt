sequenceDiagram
    participant Filter as è¿‡æ»¤å™¨
    participant Summarizer as ğŸ¤– JSæ‘˜è¦å™¨
    participant Correlator as ä¸Šä¸‹æ–‡å…³è”å™¨
    participant CorrelationAI as ğŸ¤– å…³è”åˆ†æå™¨
    participant LLM as LLMæœåŠ¡
    participant Reporter as æŠ¥å‘Š/è®°å¿†å™¨

    Note over Filter, Reporter: Aegis v4 - "æ‘˜è¦-å…³è”" å·¥ä½œæµ

    Filter->>Summarizer: 1. å‘ç°JSæ–‡ä»¶ï¼Œå‘é€è¿›è¡Œæ‘˜è¦
    activate Summarizer
    Summarizer->>LLM: 2. è¯·æ±‚å¯¹JSä»£ç è¿›è¡Œæ‘˜è¦
    LLM-->>Summarizer: 3. è¿”å›JSä»£ç æ‘˜è¦
    Summarizer->>Correlator: 4. å°†(JSäº‹ä»¶+æ‘˜è¦)å‘é€ç»™å…³è”å™¨
    deactivate Summarizer

    loop å¹¶è¡Œå‘ç”Ÿ
        Filter->>Correlator: 5. å‘ç°ç½‘ç»œè¯·æ±‚ï¼Œç›´æ¥å‘é€ç»™å…³è”å™¨
    end

    activate Correlator
    Note over Correlator: æŒç»­æ”¶é›†ç½‘ç»œè¯·æ±‚å’Œâ€œå·²æ‘˜è¦çš„JSâ€<br/>ç›´åˆ°æ»¡è¶³è§¦å‘æ¡ä»¶ (å…³é”®è¡Œä¸º/è¶…æ—¶)
    deactivate Correlator
    
    Correlator->>CorrelationAI: 6. æ‰“åŒ…å‘é€å®Œæ•´çš„ä¸Šä¸‹æ–‡ï¼ˆåŒ…å«è¯·æ±‚å’ŒJSæ‘˜è¦ï¼‰
    activate CorrelationAI
    Note over CorrelationAI: å¼€å§‹æœ€ç»ˆçš„å…³è”åˆ†æ
    CorrelationAI->>LLM: 7. (RAGå)å‘é€åŒ…å«æ‘˜è¦çš„å¤§å¸ˆçº§Prompt
    LLM-->>CorrelationAI: 8. è¿”å›æœ€ç»ˆçš„JSONæ ¼å¼æ¼æ´æŠ¥å‘Š
    deactivate CorrelationAI

    CorrelationAI->>Reporter: 9. (é€šè¿‡å¹¿æ’­å™¨)å°†æœ€ç»ˆç»“æœå‘é€åˆ°è¾“å‡ºæ¨¡å—
    activate Reporter
    Reporter->>Reporter: 10. è§£æJSONå¹¶ç”ŸæˆæŠ¥å‘Š/å­˜å…¥è®°å¿†
    deactivate Reporter