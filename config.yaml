# Aegis扫描器配置

browser:
  # 你将要启动的Chrome实例的远程调试端口。
  remote_debugging_port: 9222

browser_pool:
  mode: 'standalone'
  passive_mode_pool_size: 1
  active_mode_pool_size: 5
  pool_size: 3
  realtime_check_interval: 2
  periodic_sync_interval: 30

scanner_scope:
  whitelist_domains: ["ctf.show","121.43.58.124","127.0.0.1"]

# =================================================================
# 扫描器模块化配置
# =================================================================
scanners:
  # 在这里列出所有需要启用的扫描器模块的名称
  # 名称应与 src/scanners/ 目录下的文件名（不含.py）完全对应
  enabled:
    - xss_scanner
    - ssti_scanner
    # - js_reverse_scanner # 这个被注释掉了，所以不会加载

  # (可选) 为每个扫描器提供独立的详细配置
  # key必须与扫描器类名(ClassName)完全对应
  configs:
    XSSDynamicScanner:
      test_headers: false # 例如，可以覆盖XSS动态扫描器的默认配置
      custom_payloads:
        - "<my-custom-payload>"
    SSTIScanner:
      # SSTI扫描器的特定配置
      another_option: true

llm_service:
  reasoning_level: 'high'
  api_config:
    base_url: "http://localhost:1234/v1"
    model_name: "openai/gpt-oss-20b"
    api_key: "lm-studio"
    timeout: 500

chromadb:
  path: "./chroma_db"
  collection_name: "aegis_memories"

investigation_manager:
  execution_mode: 'passive'
  passive_mode:
    enable_interaction_monitoring: true
    analysis_depth: 'deep'
    auto_security_testing: true
    interaction_types: ['click', 'submit', 'input']
    analysis_timeout: 360
    generate_interaction_reports: true

reporter:
  output_dir: "./reports"

logging:
  ai_dialogues_file: "./logs/ai_dialogues.jsonl"

js_reverse:
  enabled: true
  analysis_mode: 'deep'
  crypto_patterns:
    function_patterns: ['encrypt', 'decrypt', 'encode', 'decode', 'hash', 'md5', 'sha', 'aes', 'rsa', 'base64']
    native_methods: ['atob', 'btoa', 'eval', 'Function', 'setTimeout', 'setInterval']
  network_monitoring:
    enabled: true
    capture_headers: ['authorization', 'token', 'signature', 'sign', 'x-token']
    capture_params: ['password', 'pass', 'pwd', 'token', 'key', 'secret']
  event_monitoring:
    event_types: ['click', 'submit', 'input', 'change', 'keydown', 'keyup']
    deep_analysis_events: ['click', 'submit']
  output:
    save_reports: true
    report_dir: "./reports/js_reverse"
    save_scripts: true
    script_dir: "./reports/js_reverse/scripts"