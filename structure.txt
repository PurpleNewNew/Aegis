
graph TD
    subgraph "é˜¶æ®µä¸€ï¼šæ•è· & å…³è”"
        direction LR
        User[ğŸ‘¤ ç”¨æˆ·] --> Browser(ğŸŒ Chromeæµè§ˆå™¨)
        Browser -- "CDPäº‹ä»¶æµ" --> Controller[CDPæ§åˆ¶å™¨]
        Controller --> Q_Raw[åŸå§‹äº‹ä»¶é˜Ÿåˆ—]
        Q_Raw --> Filter[è¿‡æ»¤å™¨Worker]
        Filter --> Q_Filtered[ç²¾ç‚¼äº‹ä»¶é˜Ÿåˆ—]
        Q_Filtered --> Correlator{ä¸Šä¸‹æ–‡å…³è”å™¨<br/>(æ ¸å¿ƒå¤§è„‘)}
    end

    subgraph "é˜¶æ®µäºŒï¼šæ•´ä½“æ€§åˆ†æ"
        direction LR
        Correlator -- "æ‰“åŒ…å®Œæ•´ä¸Šä¸‹æ–‡" --> Q_Analysis[åˆ†æä»»åŠ¡é˜Ÿåˆ—]
        Q_Analysis --> HolisticAI[ğŸ¤– æ•´ä½“åˆ†æWorker]
    end

    subgraph "å¤–éƒ¨æœåŠ¡ & æ—¥å¿—"
        direction TB
        Prompts([ğŸ“„<br/>prompts.py])
        LLM_VDB[LLMæœåŠ¡ (Ollama)<br/>&<br/>å‘é‡æ•°æ®åº“ (ChromaDB)]
        AILog([ğŸ“„<br/>logs/ai_dialogues.jsonl])
    end

    subgraph "é˜¶æ®µä¸‰ï¼šå¹¿æ’­ & è¾“å‡º"
        direction LR
        HolisticAI -- "ç»“æ„åŒ–JSON" --> Q_Out[ç»Ÿä¸€AIç»“æœé˜Ÿåˆ—]
        Q_Out --> Broadcaster[å¹¿æ’­å™¨]
        Broadcaster --> Q_Report[æŠ¥å‘Šé˜Ÿåˆ—]
        Broadcaster --> Q_Memory[è®°å¿†é˜Ÿåˆ—]

        subgraph "å¹¶è¡Œæœ€ç»ˆå¤„ç†"
            direction TB
            Q_Report --> Reporter(æŠ¥å‘Šç”Ÿæˆå™¨)
            Q_Memory --> Memory(è®°å¿†æ²‰æ·€å™¨)
        end
        Reporter -- "å†™å…¥ç»“æ„åŒ–æŠ¥å‘Š" --> ReportFile([ğŸ“„<br/>reports/*.md])
    end

    %% äº¤äº’å…³ç³»
    HolisticAI -- "è°ƒç”¨å¤§å¸ˆçº§Prompt" --> Prompts
    HolisticAI -- "RAG/æ¨ç†" --> LLM_VDB
    HolisticAI -- "è®°å½•å¯¹è¯" --> AILog
    Memory -- "å†™å…¥è®°å¿†" --> LLM_VDB

    classDef stage fill:#E8F8F5,stroke:#16A085,stroke-width:2px
    classDef services fill:#FEF9E7,stroke:#F1C40F,stroke-width:2px
    class User,Browser,ReportFile,AILog,LLM_VDB,Prompts services
    class Controller,Filter,Correlator,HolisticAI,Broadcaster,Reporter,Memory,Q_Raw,Q_Filtered,Q_Analysis,Q_Out,Q_Report,Q_Memory stage
