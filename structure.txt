graph TD
    subgraph "é˜¶æ®µä¸€ï¼šæ•èŽ· & è¿‡æ»¤"
        direction LR
        User[ðŸ‘¤ ç”¨æˆ·] --> Browser(ðŸŒ Chromeæµè§ˆå™¨)
        Browser -- "CDPäº‹ä»¶æµ" --> Controller[CDPæŽ§åˆ¶å™¨]
        Controller --> Q_Raw[åŽŸå§‹äº‹ä»¶é˜Ÿåˆ—]
        Q_Raw --> Filter[è¿‡æ»¤å™¨Worker]
    end

    subgraph "é˜¶æ®µäºŒï¼šAIé¢„å¤„ç† (JSæ‘˜è¦)"
        direction LR
        Filter -- "JSæ–‡ä»¶" --> Q_JS_Summarize[å¾…æ‘˜è¦JSé˜Ÿåˆ—]
        Q_JS_Summarize --> Summarizer[ðŸ¤– JSæ‘˜è¦å™¨Worker]
        Summarizer -- "è°ƒç”¨æ‘˜è¦Prompt" --> Prompts([ðŸ“„ prompts.py])
        Summarizer -- "è¯·æ±‚æ‘˜è¦" --> LLM_VDB[LLMæœåŠ¡]
        Summarizer -- "(JSäº‹ä»¶ + æ‘˜è¦)" --> Q_JS_Summarized[å·²æ‘˜è¦JSé˜Ÿåˆ—]
    end

    subgraph "é˜¶æ®µä¸‰ï¼šä¸Šä¸‹æ–‡å…³è”"
        direction TB
        Filter -- "ç½‘ç»œè¯·æ±‚" --> Q_Requests[ç½‘ç»œè¯·æ±‚é˜Ÿåˆ—]
        subgraph "ä¸­å¤®å…³è”å™¨"
            direction LR
            Q_Requests --> Correlator{ä¸Šä¸‹æ–‡å…³è”å™¨}
            Q_JS_Summarized --> Correlator
        end
        Correlator -- "æ‰“åŒ…å®Œæ•´ä¸Šä¸‹æ–‡" --> Q_Package[åˆ†æžåŒ…é˜Ÿåˆ—]
    end

    subgraph "é˜¶æ®µå››ï¼šAIæœ€ç»ˆå…³è”åˆ†æž"
        direction LR
        Q_Package --> CorrelationAI[ðŸ¤– å…³è”åˆ†æžWorker]
        CorrelationAI -- "è°ƒç”¨å…³è”Prompt" --> Prompts
        CorrelationAI -- "RAG/æŽ¨ç†" --> LLM_VDB
        CorrelationAI -- "è®°å½•å¯¹è¯" --> AILog([ðŸ“„ logs/...])
        CorrelationAI -- "ç»“æž„åŒ–JSON" --> Q_Out[ç»Ÿä¸€AIç»“æžœé˜Ÿåˆ—]
    end

    subgraph "é˜¶æ®µäº”ï¼šè¾“å‡º"
        direction LR
        Q_Out --> Broadcaster[å¹¿æ’­å™¨]
        Broadcaster --> Q_Report[æŠ¥å‘Šé˜Ÿåˆ—]
        Broadcaster --> Q_Memory[è®°å¿†é˜Ÿåˆ—]
        Q_Report --> Reporter(æŠ¥å‘Šç”Ÿæˆå™¨)
        Q_Memory --> Memory(è®°å¿†æ²‰æ·€å™¨)
        Reporter --> ReportFile([ðŸ“„ reports/...])
        Memory -- "å†™å…¥è®°å¿†" --> LLM_VDB
    end

    classDef stage fill:#E8F8F5,stroke:#16A085,stroke-width:2px
    classDef services fill:#FEF9E7,stroke:#F1C40F,stroke-width:2px
    class User,Browser,ReportFile,AILog,LLM_VDB,Prompts services
    class Controller,Filter,Summarizer,Correlator,CorrelationAI,Broadcaster,Reporter,Memory,Q_Raw,Q_Requests,Q_JS_Summarize,Q_JS_Summarized,Q_Package,Q_Out,Q_Report,Q_Memory stage